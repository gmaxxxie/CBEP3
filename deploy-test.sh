#!/bin/bash

# Chromeæ‰©å±•æµ‹è¯•éƒ¨ç½²è„šæœ¬

echo "ðŸš€ å¼€å§‹éƒ¨ç½²Chromeæ‰©å±•è¿›è¡Œæµ‹è¯•..."

# 1. æ£€æŸ¥å¿…è¦æ–‡ä»¶
echo "ðŸ“ æ£€æŸ¥é¡¹ç›®æ–‡ä»¶ç»“æž„..."
if [ ! -f "manifest.json" ]; then
    echo "âŒ manifest.json æ–‡ä»¶ç¼ºå¤±"
    exit 1
fi

if [ ! -d "src" ]; then
    echo "âŒ src ç›®å½•ç¼ºå¤±"
    exit 1
fi

if [ ! -d "data" ]; then
    echo "âŒ data ç›®å½•ç¼ºå¤±"
    exit 1
fi

echo "âœ… é¡¹ç›®æ–‡ä»¶ç»“æž„æ£€æŸ¥é€šè¿‡"

# 2. éªŒè¯manifest.json
echo "ðŸ“ éªŒè¯manifest.json..."
node -e "
try {
    const manifest = require('./manifest.json');
    if (manifest.manifest_version !== 3) {
        throw new Error('éœ€è¦Manifest V3');
    }
    console.log('âœ… ManifestéªŒè¯é€šè¿‡');
    console.log('   æ‰©å±•åç§°:', manifest.name);
    console.log('   ç‰ˆæœ¬:', manifest.version);
} catch (error) {
    console.error('âŒ ManifestéªŒè¯å¤±è´¥:', error.message);
    process.exit(1);
}
"

# 3. åˆ›å»ºæµ‹è¯•æ•°æ®
echo "ðŸ“Š å‡†å¤‡æµ‹è¯•æ•°æ®..."
if [ ! -f "data/sources/countries.json" ]; then
    echo "âš ï¸  å›½å®¶æ•°æ®æ–‡ä»¶ç¼ºå¤±ï¼Œå°†å½±å“æœ¬åœ°åˆ†æžåŠŸèƒ½"
fi

# 4. æ£€æŸ¥æƒé™é…ç½®
echo "ðŸ”’ æ£€æŸ¥æƒé™é…ç½®..."
echo "   éœ€è¦çš„æƒé™: activeTab, storage, scripting, tabs"
echo "   ä¸»æœºæƒé™: https://*/*"

# 5. ç”ŸæˆåŠ è½½è¯´æ˜Ž
cat > TESTING_GUIDE.md << 'EOF'
# Chromeæ‰©å±•æµ‹è¯•æŒ‡å—

## åŠ è½½æ‰©å±•æ­¥éª¤

1. **æ‰“å¼€Chromeæ‰©å±•ç®¡ç†é¡µé¢**
   - åœ°å€æ è¾“å…¥: `chrome://extensions/`
   - æˆ–è€…: èœå• â†’ æ›´å¤šå·¥å…· â†’ æ‰©å±•ç¨‹åº

2. **å¯ç”¨å¼€å‘è€…æ¨¡å¼**
   - å³ä¸Šè§’åˆ‡æ¢"å¼€å‘è€…æ¨¡å¼"å¼€å…³

3. **åŠ è½½æœªæ‰“åŒ…çš„æ‰©å±•ç¨‹åº**
   - ç‚¹å‡»"åŠ è½½å·²è§£åŽ‹çš„æ‰©å±•ç¨‹åº"
   - é€‰æ‹©é¡¹ç›®æ ¹ç›®å½• (åŒ…å«manifest.jsonçš„ç›®å½•)

4. **éªŒè¯åŠ è½½æˆåŠŸ**
   - æ‰©å±•åˆ—è¡¨ä¸­å‡ºçŽ°"è·¨å¢ƒç”µå•†åœ°åŸŸé€‚é…åˆ†æžå™¨"
   - æµè§ˆå™¨å·¥å…·æ å‡ºçŽ°æ‰©å±•å›¾æ ‡

## åŠŸèƒ½æµ‹è¯•æ¸…å•

### åŸºç¡€åŠŸèƒ½æµ‹è¯•
- [ ] æ‰©å±•å›¾æ ‡æ˜¾ç¤ºæ­£å¸¸
- [ ] ç‚¹å‡»å›¾æ ‡æ‰“å¼€Popupç•Œé¢
- [ ] Popupç•Œé¢æ˜¾ç¤ºå®Œæ•´
- [ ] åœ°åŒºé€‰æ‹©åŠŸèƒ½æ­£å¸¸
- [ ] åˆ†æžæŒ‰é’®å¯ç‚¹å‡»

### å†…å®¹åˆ†æžæµ‹è¯•
å»ºè®®æµ‹è¯•ç½‘ç«™:
1. **äºšé©¬é€Š** - https://amazon.com
2. **æ·˜å®** - https://taobao.com  
3. **Shopifyç¤ºä¾‹åº—** - https://checkout.shopify.com
4. **ç‹¬ç«‹ç”µå•†ç«™** - ä»»æ„ç”µå•†ç½‘ç«™

æµ‹è¯•æ­¥éª¤:
1. è®¿é—®æµ‹è¯•ç½‘ç«™
2. ç‚¹å‡»æ‰©å±•å›¾æ ‡
3. é€‰æ‹©ç›®æ ‡åœ°åŒº (ç¾Žå›½ã€è‹±å›½ã€å¾·å›½ç­‰)
4. ç‚¹å‡»"å¼€å§‹åˆ†æž"
5. ç­‰å¾…åˆ†æžå®Œæˆ
6. æŸ¥çœ‹åˆ†æžç»“æžœ

### æŠ¥å‘ŠåŠŸèƒ½æµ‹è¯•
- [ ] HTMLæŠ¥å‘Šç”Ÿæˆ
- [ ] PDFæŠ¥å‘Šå¯¼å‡º
- [ ] CSVæ•°æ®å¯¼å‡º
- [ ] æŠ¥å‘Šå†…å®¹å®Œæ•´æ€§

### è®¾ç½®é¡µé¢æµ‹è¯•
- [ ] å³é”®æ‰©å±•å›¾æ ‡ â†’ é€‰é¡¹
- [ ] è®¾ç½®é¡µé¢æ­£å¸¸æ˜¾ç¤º
- [ ] AIä¾›åº”å•†é…ç½®
- [ ] APIå¯†é’¥è®¾ç½®

## é—®é¢˜æŽ’æŸ¥

### æŽ§åˆ¶å°æ—¥å¿—æŸ¥çœ‹
1. **æ‰©å±•é¡µé¢**: `chrome://extensions/`
2. **ç‚¹å‡»**: æ‰©å±•è¯¦æƒ… â†’ "æŸ¥çœ‹è§†å›¾" â†’ background.html
3. **æ‰“å¼€**: å¼€å‘è€…å·¥å…· â†’ Consoleæ ‡ç­¾

### å†…å®¹è„šæœ¬æ—¥å¿—
1. **è®¿é—®**: ä»»æ„ç½‘é¡µ
2. **æŒ‰F12**: æ‰“å¼€å¼€å‘è€…å·¥å…·
3. **Consoleæ ‡ç­¾**: æŸ¥çœ‹å†…å®¹è„šæœ¬æ—¥å¿—

### å¸¸è§é—®é¢˜
1. **åˆ†æžæ— å“åº”**: æ£€æŸ¥ç½‘ç»œè¿žæŽ¥å’ŒAPIå¯†é’¥
2. **é¡µé¢æ•°æ®æå–å¤±è´¥**: æŸ¥çœ‹æŽ§åˆ¶å°é”™è¯¯ä¿¡æ¯
3. **PDFå¯¼å‡ºå¤±è´¥**: å¯èƒ½éœ€è¦å…è®¸å¼¹çª—æƒé™

## æµ‹è¯•æ•°æ®è®°å½•

è¯·è®°å½•ä»¥ä¸‹æµ‹è¯•æ•°æ®:
- æµ‹è¯•ç½‘ç«™URL
- é€‰æ‹©çš„ç›®æ ‡åœ°åŒº  
- åˆ†æžè€—æ—¶
- å‘çŽ°çš„é—®é¢˜
- åˆ†æžç»“æžœå‡†ç¡®æ€§

EOF

echo "âœ… æµ‹è¯•æŒ‡å—å·²ç”Ÿæˆ: TESTING_GUIDE.md"

# 6. æœ€ç»ˆæ£€æŸ¥æç¤º
echo ""
echo "ðŸŽ¯ Chromeæ‰©å±•æµ‹è¯•éƒ¨ç½²å®Œæˆ!"
echo ""
echo "ðŸ“‹ ä¸‹ä¸€æ­¥æ“ä½œ:"
echo "   1. é˜…è¯» TESTING_GUIDE.md"
echo "   2. åœ¨Chromeä¸­åŠ è½½æ‰©å±•"
echo "   3. è®¿é—®ç”µå•†ç½‘ç«™æµ‹è¯•åŠŸèƒ½"
echo "   4. è®°å½•æµ‹è¯•ç»“æžœå’Œé—®é¢˜"
echo ""
echo "âš ï¸  æ³¨æ„äº‹é¡¹:"
echo "   - é¦–æ¬¡ä½¿ç”¨éœ€è¦é…ç½®AI APIå¯†é’¥"
echo "   - æŸäº›åŠŸèƒ½éœ€è¦ç½‘ç»œè¿žæŽ¥"
echo "   - å»ºè®®åœ¨å¼€å‘è€…æ¨¡å¼ä¸‹æµ‹è¯•"
echo ""